@model IEnumerable<FacturacionElectronicaSV.Models.Receptor>

<div class="container mt-4">
    <h4>Listado de Clientes</h4>

    @if (TempData["Mensaje"] != null)
    {
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            @TempData["Mensaje"]
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
        </div>
    }

    <div class="mb-3 text-end">
        <a asp-action="Crear" class="btn btn-primary">Registrar Nuevo Cliente</a>
    </div>

    <table class="table table-bordered table-striped">
        <thead class="table-dark text-center">
            <tr>
                <th>#</th>
                <th>Nombre</th>
                <th>Tipo Documento</th>
                <th>Número Documento</th>
                <th>Correo</th>
                <th>Teléfono</th>
                <th>Departamento</th>
                <th>Municipio</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            @if (!Model.Any())
            {
                <tr>
                    <td colspan="9" class="text-center text-muted">No hay clientes registrados.</td>
                </tr>
            }
            else
            {
                int index = 1;
                foreach (var item in Model)
                {
                    <tr>
                        <td class="text-center">@index</td>
                        <td>@item.Nombre</td>
                        <td>@item.TipoDocumento</td>
                        <td>@item.NumeroDocumento</td>
                        <td>@item.Correo</td>
                        <td>@item.Telefono</td>
                        <td>@item.Departamento</td>
                        <td>@item.Municipio</td>
                        <td class="text-center">
                            <div class="d-flex justify-content-center gap-2">
                                <a asp-action="Editar" asp-route-id="@item.IdReceptor" class="btn btn-sm btn-warning">Editar</a>

                                <button type="button" class="btn btn-sm btn-danger" data-bs-toggle="modal" data-bs-target="#confirmModal-@item.IdReceptor">
                                    Eliminar
                                </button>
                            </div>

                            <div class="modal fade" id="confirmModal-@item.IdReceptor" tabindex="-1" aria-labelledby="confirmModalLabel-@item.IdReceptor" aria-hidden="true">
                                <div class="modal-dialog modal-dialog-centered">
                                    <div class="modal-content border-0 shadow">
                                        <div class="modal-header bg-danger text-white">
                                            <h5 class="modal-title" id="confirmModalLabel-@item.IdReceptor">Confirmar Eliminación</h5>
                                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                                        </div>
                                        <div class="modal-body text-center">
                                            <p class="mb-0">¿Está seguro que desea eliminar el cliente <strong>@item.Nombre</strong>?</p>
                                            <small class="text-muted">Esta acción no se puede deshacer.</small>
                                        </div>
                                        <div class="modal-footer justify-content-center">
                                            <form asp-action="Eliminar" asp-route-id="@item.IdReceptor" method="post">
                                                <button type="submit" class="btn btn-outline-danger px-4">Eliminar</button>
                                            </form>
                                            <button type="button" class="btn btn-secondary px-4" data-bs-dismiss="modal">Cancelar</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </td>
                    </tr>
                    index++;
                }
            }
        </tbody>
    </table>

    <div class="text-center mt-5">
        <button id="btnVolver" class="btn btn-outline-primary px-5 rounded-pill fw-bold">
            Volver al Panel de Documentos
        </button>

        <div id="mensajeVolver" class="mt-3" style="display: none;">
            <div class="alert alert-info border-start border-4 border-primary shadow-sm" role="alert">
                <strong>Regresando al Index...</strong>
            </div>
        </div>
    </div>
</div> <!-- Este cierre es del container principal -->
@section Scripts {
    <script>
        document.getElementById("btnVolver").addEventListener("click", function () {
            const mensaje = document.getElementById("mensajeVolver");
            mensaje.style.display = "block";

            setTimeout(function () {
                window.location.href = "/Documento/Index";
            }, 1800);
        });
    </script>
}